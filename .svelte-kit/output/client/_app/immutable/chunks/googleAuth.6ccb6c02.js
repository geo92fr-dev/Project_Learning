import{_ as o}from"./preload-helper.a4192956.js";import{d as m,w as c}from"./index.ce9bc0b6.js";const d=c(null),h=c(!1),p=c(null),A=m(d,e=>e!==null);function n(e){h.set(e)}function u(e){p.set(e)}function s(e){d.set(e)}function w(){p.set(null)}async function y(){n(!0),u(null);try{const{auth:e}=await o(()=>import("./config.543ed14e.js"),["./config.543ed14e.js","./preload-helper.a4192956.js"],import.meta.url),{signInWithPopup:t,GoogleAuthProvider:a}=await o(()=>import("./index.esm.214c7bcb.js"),["./index.esm.214c7bcb.js","./index.esm.cef20287.js"],import.meta.url);if(!e)throw new Error("Firebase auth not initialized");const i=new a;i.addScope("email"),i.addScope("profile");const r=await t(e,i),l={uid:r.user.uid,email:r.user.email,displayName:r.user.displayName,photoURL:r.user.photoURL,emailVerified:r.user.emailVerified,createdAt:r.user.metadata.creationTime,lastLoginAt:r.user.metadata.lastSignInTime};return s(l),console.log("✅ Google authentication successful:",l.email),{success:!0,user:l}}catch(e){const t=g(e);return u(t),console.error("❌ Google authentication failed:",e),{success:!1,error:t}}finally{n(!1)}}async function v(){n(!0),u(null);try{const{auth:e}=await o(()=>import("./config.543ed14e.js"),["./config.543ed14e.js","./preload-helper.a4192956.js"],import.meta.url),{signOut:t}=await o(()=>import("./index.esm.214c7bcb.js"),["./index.esm.214c7bcb.js","./index.esm.cef20287.js"],import.meta.url);return e&&await t(e),s(null),console.log("👋 User signed out successfully"),{success:!0}}catch(e){const t="Erreur lors de la déconnexion";return u(t),console.error("❌ Sign out failed:",e),{success:!1,error:t}}finally{n(!1)}}async function _(){try{const{auth:e}=await o(()=>import("./config.543ed14e.js"),["./config.543ed14e.js","./preload-helper.a4192956.js"],import.meta.url),{onAuthStateChanged:t}=await o(()=>import("./index.esm.214c7bcb.js"),["./index.esm.214c7bcb.js","./index.esm.cef20287.js"],import.meta.url);if(!e){console.warn("⚠️ Firebase auth not available for state listener");return}t(e,a=>{if(a){const i={uid:a.uid,email:a.email,displayName:a.displayName,photoURL:a.photoURL,emailVerified:a.emailVerified,createdAt:a.metadata.creationTime,lastLoginAt:a.metadata.lastSignInTime};s(i),console.log("🔄 Auth state changed: user signed in")}else s(null),console.log("🔄 Auth state changed: user signed out")})}catch(e){console.error("❌ Auth listener setup failed:",e)}}function g(e){switch(e.code){case"auth/popup-closed-by-user":return"Connexion annulée par l'utilisateur";case"auth/popup-blocked":return"Popup bloquée par le navigateur. Veuillez autoriser les popups.";case"auth/cancelled-popup-request":return"Demande de connexion annulée";case"auth/network-request-failed":return"Erreur réseau. Vérifiez votre connexion internet.";case"auth/too-many-requests":return"Trop de tentatives. Veuillez réessayer plus tard.";case"auth/user-disabled":return"Ce compte a été désactivé.";default:return e.message||"Erreur d'authentification inconnue"}}_();export{v as a,w as c,p as e,A as i,h as l,y as s,d as u};
